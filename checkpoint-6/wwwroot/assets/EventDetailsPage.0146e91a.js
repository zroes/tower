import{_ as M,i as F,b as q,d as _,l as r,P as i,A as l,j as L,k as P,C as z,c,a as t,t as m,n as R,F as h,r as V,w as U,m as G,v as H,q as B,u as J,s as N,o as a,e as K,g as O}from"./index.602168d1.js";import{t as u}from"./TicketsService.b31e172f.js";const Q={setup(){const v=J(),s=v.params.eventId,g=F("");async function o(){try{await L.getById(s)}catch(e){r.error(e),i.error(e.message)}}async function f(){try{await u.getTickets(s)}catch(e){r.error(e),i.error(e.message)}}async function w(){try{await P.getAll(s)}catch(e){r.error(e),i.error(e.message)}}return q(()=>{o(),f(),w()}),{towerEvent:_(()=>l.activeEvent),tickets:_(()=>l.tickets),account:_(()=>l.account),comments:_(()=>l.comments),editable:g,isAttending:_(()=>{const e=l.tickets.findIndex(d=>d.accountId==l.account.id);return r.log(e!=-1),e!=-1}),async createTicket(){try{const e={};e.eventId=v.params.eventId,await u.createTicket(e)}catch(e){r.error(e),i.error(e.message)}},async deleteTicket(){try{const e=l.tickets.find(d=>d.accountId==l.account.id);await u.deleteTicket(e.id)}catch(e){r.error(e),i.error(e.message)}},async cancelEvent(){try{const e=v.params.eventId;await i.confirm("Are you sure you want to cancel this event?","This action can't be undone!")&&await L.cancelEvent(e)}catch(e){r.error(e),i.error(e.message)}},async postComment(){try{await P.postComment(g.value,s),g.value=""}catch(e){r.error(e),i.error(e.message)}}}},components:{Comment:z}},W={class:"glass-bg row m-0"},X={class:"col-5 d-flex"},Y=["src"],Z={class:"col-7 d-grid light text-shadow"},$={class:""},tt={class:"row m-4"},et={class:"fw-bold col"},ot={class:"col text-end lb"},nt={class:"row m-4"},st={class:"col lb"},ct={class:"row m-4"},at={class:"col"},rt={class:"fw-light description"},it={class:"row m-4 align-content-end"},lt={class:"col align-content-end d-flex flex-wrap"},dt={class:"m-0"},_t={class:"accent"},mt=N(" spots left"),vt={class:"col text-end"},gt={key:0,disabled:"",class:"btn btn-danger p-3"},ht={key:1,disabled:"",class:"btn btn-danger fw-light p-3"},ut=N("Attend "),ft=t("i",{class:"mdi mdi-badge-account"},null,-1),wt=[ut,ft],yt=t("span",null,"Attending",-1),bt=[yt],pt={key:4,class:"btn btn-dark hide p-3"},Et={class:"container mt-4"},xt={class:"row"},Ct={class:"d-flex col-1"},kt=["src","title","alt"],Tt={class:"mt-4 row justify-content-center"},It={class:"col-9 bg-secondary rounded p-3 justify-content-center"},At={class:"row justify-content-center"},St={class:"col-8 mt-4 mb--2"},Dt={class:"form-floating"},jt=t("label",{class:"fw-light",for:"floatingTextarea"},"Leave a comment",-1),Lt=t("div",{class:"text-end mt-2"},[t("button",{class:"btn btn-warning me-2 elevation-1"},"Post")],-1),Pt={class:"row justify-content-center"},Vt={key:0,class:"row justify-content-center mt-5"},Bt={class:"col-3 text-center"};function Nt(v,s,g,o,f,w){var d,y,b,p,E,x,C,k,T,I,A;const e=O("Comment");return a(),c(h,null,[t("div",{class:"bg-img",style:R(`background-image: url(${(d=o.towerEvent)==null?void 0:d.coverImg})`)},[t("div",W,[t("div",X,[t("img",{class:"rounded align-self-center m-5 cover-img-page",src:(y=o.towerEvent)==null?void 0:y.coverImg,alt:""},null,8,Y)]),t("div",Z,[t("div",$,[t("div",tt,[t("h2",et,m((b=o.towerEvent)==null?void 0:b.name),1),t("h3",ot,m((p=o.towerEvent)==null?void 0:p.startDate.toLocaleDateString()),1)]),t("div",nt,[t("h4",st,m((E=o.towerEvent)==null?void 0:E.location),1)]),t("div",ct,[t("div",at,[t("h6",rt,m((x=o.towerEvent)==null?void 0:x.description),1)])])]),t("div",it,[t("div",lt,[t("p",dt,[t("span",_t,m((C=o.towerEvent)==null?void 0:C.capacity),1),mt])]),t("div",vt,[(k=o.towerEvent)!=null&&k.isCanceled?(a(),c("button",gt,"Canceled")):((T=o.towerEvent)==null?void 0:T.capacity)==0?(a(),c("button",ht,"At Capacity")):o.account.id&&!o.isAttending?(a(),c("button",{key:2,onClick:s[0]||(s[0]=n=>o.createTicket()),class:"btn btn-warning fw-light p-3"},wt)):o.account.id?(a(),c("button",{key:3,onClick:s[1]||(s[1]=n=>o.deleteTicket()),title:"Leave this event",class:"unattend btn btn-secondary fw-light p-3"},bt)):(a(),c("button",pt,"|"))])])])])],4),t("section",Et,[t("div",xt,[(a(!0),c(h,null,V(o.tickets,n=>{var S,D,j;return a(),c("div",Ct,[t("img",{class:"attendee-img rounded d-flex",src:(S=n==null?void 0:n.profile)==null?void 0:S.picture,title:(D=n==null?void 0:n.profile)==null?void 0:D.name,alt:(j=n==null?void 0:n.profile)==null?void 0:j.name},null,8,kt)])}),256))])]),t("section",Tt,[t("div",It,[t("div",At,[t("div",St,[t("form",{class:"",onSubmit:s[3]||(s[3]=U(n=>o.postComment(),["prevent"]))},[t("div",Dt,[G(t("textarea",{"onUpdate:modelValue":s[2]||(s[2]=n=>o.editable=n),class:"form-control elevation-2",placeholder:"Leave a comment here",id:"floatingTextarea",style:{height:"100px"}},null,512),[[H,o.editable]]),jt]),Lt],32)])]),(a(!0),c(h,null,V(o.comments,n=>(a(),c("div",Pt,[K(e,{comment:n},null,8,["comment"])]))),256))])]),(I=o.towerEvent)!=null&&I.isCanceled?B("",!0):(a(),c("div",Vt,[t("div",Bt,[((A=o.towerEvent)==null?void 0:A.creatorId)==o.account.id?(a(),c("button",{key:0,onClick:s[4]||(s[4]=n=>o.cancelEvent()),class:"px-5 btn btn-danger"},"Cancel Event")):B("",!0)])]))],64)}const qt=M(Q,[["render",Nt]]);export{qt as default};
